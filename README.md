# Shortener2

###### Версия 2.0 от 31.05.2022

Простой сокращатель ссылок со сбором статистики, написанный на Laravel.

Разработчик: [mrNiKitus](https://mrnikitus.ru).

## Основные особенности: 

1. Простой и быстрый интерфейс на Bootstrap 3. Ничего лишнего
2. Высокая скорость работы за счёт оптимизаций (_сложные запросы к БД_)
3. Возможность добавления пользователей с разными правами.

## Используемые технологии

1. [Laravel Framework](https://laravel.com) 9.12.1
2. [Bootstrap](https://getbootstrap.com/docs/3.4/) 3.4.1
3. [Google Charts](https://developers.google.com/chart)
4. [Laravel Fortify](https://github.com/laravel/fortify) 1.13.0

## Установка

### Системные требования
1. [PHP](https://www.php.net/) >=8.0
2. [MySQL](https://www.mysql.com/) >=8.0
3. [Node.js](https://nodejs.org/) >=17.6.0
4. [Composer](https://getcomposer.org/)

### Порядок установки

1. Для начала запустите консоль, перейдите в папку проекта и выполните команду `composer install` для установки всех зависимостей проекта.
2. Для сборки файлов фронтенда выполните команду `npm install`, а затем `npn run prod`.
3. Откройте файл `.env.example` и внесите настройки своей базы данных MySQL (всё, что начинается с `DB_`), адрес сервера (переменная `APP_URL`), а также выберите, нужно ли включать режим отладки (`APP_DEBUG` имеет значение _true_ или _false_). Сохраните файл под названием `.env`.
4. Для генерации ключа проекта выполните команду `php artisan key:generate`.
5. Выполните команду `php artisan migrate` для применения миграций базы данных.
6. Для создания пользователя выполните команду `php artisan superuser` и введите данные создаваемого пользователя.
7. Теперь для запуска тестового сервера выполните команду `php artisan serve`. Сервер запустится по адресу `127.0.0.1:8000`.
8. Если запускаете на реальном сервере с поддержкой PHP, настройте корень сайта на папку `public`, а корневой файл `index.php`.

### Тестовые данные

Если хотите заполнить сайт тестовыми данными (возможно, чтобы протестировать его на нагрузку), можно использовать следующие команды:
1. `php artisan generate:users` - генерирует 40 пользователей с разными правами.
2. `php artisan generate:addresses` - генерирует 200 адресов и ссылки на них. Адреса прикрепляются рандомно к пользователям с id от 1 до 40.
3. `php artisan generate:statistics` - генерирует 50000 посещений и рандомно присваивает их адресам с id от 1 до 200.

## Использование

### Права доступа

Существует три категории пользователей по правам доступа: _пользователь_, _модератор_, _администратор_.

Все пользователи не могут удалять свой аккаунт, а для смены пароля им нужно вводить свой старый пароль.

Список прав доступа по пользователям:
1. **Пользователь**:
 - добавлять/смотреть/изменять/удалять свои адреса.
2. **Модератор**: 
 - добавлять/смотреть/изменять/удалять свои адреса;
 - смотреть список всех адресов;
 - смотреть/изменять/удалять адреса других пользователей и модераторов;
 - добавлять новых пользователей;
 - смотреть/изменять других пользователей и модераторов;
 - удалять пользователей.
3. **Администратор**:
 - добавлять/смотреть/изменять/удалять свои адреса;
 - смотреть список всех адресов;
 - смотреть/изменять/удалять адреса других пользователей, модераторов и администраторов;
 - смотреть/изменять/удалять других пользователей, модераторов и администраторов;
 - удалять пользователей, модераторов, администраторов;
 - добавлять/изменять роли.

### Данные для создания пользователя

Для создания пользователя требуется его имя (если не указать, будет взят логин), логин для входа, электронная почта (необязательно) и пароль. Роль по умолчанию для новых пользователей - "пользователь" (только администратор может назначать роли).

### Данные для создания адреса

Для создания адреса минимально нужен только URL, причем с указанным протоколом (http:// или https://). Также можно указать имя (по умолчанию устанавливается URL) и сокращение (по умолчанию генерируется 6-значный набор из английских букв в разном регистре и цифр).

Длина сокращения - от 3 до 30 символов, может содержать буквы разных регистров, цифры и тире с подчеркиваниями. Запрещены сокращения, начинающиеся со служебных слов (_users_, _addresses_, _login_ и _logout_).

### Статистика

Для статистики собирается время посещения ссылки и IP-адрес, с которого было произведено посещение.

В разделе статистики отображаются все посещения, а также диаграмма, на которой указываются посещения за последний месяц. Если посещений за этот период нет, диаграмма не отображается.
